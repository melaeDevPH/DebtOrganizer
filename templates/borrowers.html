<!DOCTYPE html>
<html>
<head>
    <title>Borrowers list | Debt Organizer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <link rel="icon" type="image/jpeg" href="{{ url_for('static', filename='app.jpg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/style1.css') }}"> 
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

</head>
<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <img src="{{ url_for('static', filename='app.png') }}" alt="Logo" style="width: 100px; height: auto;">
          <a class="navbar-brand" href="/borrowers"><b>Debt Organizer</b></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="/borrowers">Dashboard</a>
                </li>
              
                <li class="nav-item">
                    <a class="nav-link" href="/calculator">Calculator</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Payment history</a>
                </li>
            </ul>
            <button type="button" class="btn btn-primary btn-gradient ms-auto" data-bs-toggle="modal" data-bs-target="#addBorrowerModal">
                <i class="bi bi-plus"></i> Add New Borrower
            </button>
        </div>
        
        </div>
      </nav>
    <div class="container mt-3">

        <div class="container text-center mb-4">
            <div class="row">
                <div class="col-md-6">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title"><i class="bi bi-people"></i> Total Borrowers</h5>
                            <p class="card-text display-6">{{ borrower_count }}</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title"><i class="bi bi-cash-stack"></i> Total Amount Borrowed</h5>
                            <p class="card-text display-6">₱{{ total_amount }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        
        <div class="row">

            <div class="d-flex justify-content-between align-items-center">
                <p class="text-white mb-0">Recent Borrower</p>
                {% if borrowers|length > 3 %}
                    <button class="btn btn-primary mb-1" onclick="location.href='/all-borrowers'">
                        View all <i class="bi bi-chevron-right fs-6"></i>
                    </button>
                {% endif %}
            </div>
            
            {% for borrower in borrowers[:3] %} 
            <div class="col-md-4">
                <div class="borrower-card random-bg">
                    <div class="dropdown">
                        <button class="btn btn-light">⋮</button>
                        <div class="dropdown-content">
                            <a href="/edit/{{ borrower[0] }}">Edit</a>
                            <form action="/delete/{{ borrower[0] }}" method="POST" onsubmit="return confirm('Do you want to delete this record?')">
                                <button type="submit">Delete</button>
                            </form>
                            <form action="/mark-paid/{{ borrower[0] }}" method="POST" onsubmit="return confirm('Mark as paid?')">
                                <button type="submit">Paid</button>
                            </form>
                        </div>
                    </div>
                    <h5 class="borrower-title">{{ borrower[1] }}</h5>
                    <h5 class="card-title fw-bold">Loan Details</h5>
                    <div class="d-flex justify-content-between">
                        <span><strong>Loan Type:</strong></span>
                        <span>{{ borrower[2] }}</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span><strong>Payment Day:</strong></span>
                        <span>{{ borrower[3] }}</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span><strong>Due Date:</strong></span>
                        <span>{{ borrower[4] }}</span>
                    </div>
                    <div class="d-flex justify-content-between text-warning fw-bold">
                        <span><strong>Amount:</strong></span>
                        <span>₱{{ borrower[5] }}</span>
                    </div>
                    <div class="d-flex justify-content-between fw-bold">
                        <span><strong>Status:</strong></span>
                        <span class="{{ 'text-danger' if borrower[6].strip().lower() == 'unpaid' else 'text-success' }}">
                            {{ borrower[6] }}
                        </span>                        
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        
        
    </div>
    <div class="modal fade" id="addBorrowerModal" tabindex="-1" aria-labelledby="addBorrowerModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content custom-modal">
                <div class="modal-header">
                    <h5 class="modal-title" id="addBorrowerModalLabel">Add New Borrower</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="/add_borrower" method="POST">
                        <div class="mb-3">
                            <label for="name" class="form-label">Name:</label>
                            <input type="text" class="form-control" id="name" name="name" placeholder="Enter name" required>
                        </div>
    
                        <div class="mb-3">
                            <label for="loan_type" class="form-label">Loan Type:</label>
                            <input type="text" class="form-control" id="loan_type" name="loan_type" placeholder="Enter loan type" required>
                        </div>
    
                        <div class="mb-3">
                            <label for="date_of_payment" class="form-label">Weekly Payment Day:</label>
                            <input type="text" class="form-control" id="date_of_payment" name="day_of_payment" placeholder="Enter payment day" required>
                        </div>
    
                        <div class="mb-3">
                            <label for="due_date" class="form-label">Due Date:</label>
                            <input type="date" class="form-control" id="due_date" name="due_date" required>
                        </div>
    
                        <div class="mb-3">
                            <label for="amount" class="form-label">Amount:</label>
                            <input type="number" class="form-control" id="amount" name="amount" placeholder="Enter amount" required>
                        </div>
    
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-light text-primary">Add Borrower</button>
                            <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Close</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
   
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            gsap.from(".col-md-4 .card", {
                opacity: 0,
                y: 30,
                duration: 0.8,
                stagger: 0.2, // Each card animates with a delay
                ease: "power2.out"
            });
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const cards = document.querySelectorAll(".random-bg");
                    const colors = [
            "#D6E4FF", // Soft Sky Blue
            "#FCE4EC", // Light Blush Pink
            "#E3F2FD", // Pastel Blue
            "#F3E5F5", // Soft Lavender
            "#FFF9C4", // Light Warm Yellow
            "#E8F5E9", // Mint Pastel Green
            "#FFEBEE", // Baby Pink
            "#D1F5FF", // Soft Aqua
            "#F5F5F5", // Light Grey (Neutral)
            "#E0F2F1"  // Teal Mist
        ];


            cards.forEach(card => {
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                card.style.backgroundColor = randomColor;
            });
        });
    </script>
 
    <script>
        document.addEventListener("DOMContentLoaded", function () {
    const navbar = document.querySelector(".navbar");

    window.addEventListener("scroll", function () {
        if (window.scrollY > 50) { // Adjust the scroll threshold as needed
            navbar.classList.add("scrolled");
        } else {
            navbar.classList.remove("scrolled");
        }
    });
});

    </script>
    
</body>
</html>